"use strict";var __decorate=this&&this.__decorate||function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core");require("rxjs/add/operator/debounceTime"),require("rxjs/add/operator/distinctUntilChanged"),require("rxjs/add/operator/do"),require("rxjs/add/operator/takeUntil");var monaco_editor_component_1=require("../../monaco-editor/monaco-editor.component"),single_emission_subject_1=require("../shared/single-emission-subject"),editor_service_1=require("./editor.service"),EditorComponent=function(){function e(e){this.editorService=e,this.expression="",this.ngDestroy=single_emission_subject_1.SingleEmissionSubject.create()}return e.prototype.ngOnInit=function(){var e=this;this.editorService.context$.distinctUntilChanged().takeUntil(this.ngDestroy).subscribe(function(t){if(t){var o=t.expression||"";e.editor.changeModel(o)}}),this.editorService.insert$.takeUntil(this.ngDestroy).subscribe(function(t){t.replaceTokenAtPosition?e.editor.replaceTokenAtClientPosition(t.text,t.replaceTokenAtPosition):e.editor.insert(t.text)}),this.editorService.dragOver$.takeUntil(this.ngDestroy).subscribe(function(t){e.editor.selectTokenAtClientPosition(t)}),this.editorService.validate$.takeUntil(this.ngDestroy).subscribe(function(t){e.editor.setErrors(t)}),this.editor.valueChange.debounceTime(300).distinctUntilChanged().takeUntil(this.ngDestroy).subscribe(function(t){e.editorService.outputExpression(t)})},e.prototype.ngOnDestroy=function(){this.ngDestroy.emitAndComplete()},e}();__decorate([core_1.ViewChild(monaco_editor_component_1.MonacoEditorComponent),__metadata("design:type",monaco_editor_component_1.MonacoEditorComponent)],EditorComponent.prototype,"editor",void 0),EditorComponent=__decorate([core_1.Component({moduleId:module.id,selector:"tibco-mapper-editor",template:"<monaco-editor></monaco-editor>"}),__metadata("design:paramtypes",[editor_service_1.EditorService])],EditorComponent),exports.EditorComponent=EditorComponent;