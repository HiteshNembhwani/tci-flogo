"use strict";var __decorate=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,l=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(l=(r<3?i(l):r>3?i(t,o,l):i(t,o))||l);return r>3&&l&&Object.defineProperty(t,o,l),l},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),lodash=require("lodash"),platform_browser_1=require("@angular/platform-browser"),Contenteditable=function(){function e(e,t){this.el=e,this.sanitizer=t,this.myContenteditableChange=new core_1.EventEmitter,this._el=e.nativeElement,this.$el=jQuery(this._el)}return e.prototype.ngOnChanges=function(e){lodash.has(e,"myContenteditable")&&e.myContenteditable.currentValue&&this.$el.html(this.sanitizer.sanitize(core_1.SecurityContext.HTML,e.myContenteditable.currentValue))},e.prototype.ngOnInit=function(){void 0!==this.myContenteditable&&this.$el.html(this.sanitizer.sanitize(core_1.SecurityContext.HTML,this.myContenteditable)),this.$el.attr("contenteditable","true"),this.$el.css({outline:"none",lineHeight:parseInt(this.$el.css("lineHeight"),10)-2+"px",border:"1px solid transparent"}),this._initPlaceholder(),"rgb(255, 255, 255)"===this.$el.css("color")&&(this.colorFlag=!0)},e.prototype.onMouseEnter=function(){document.activeElement!==this._el&&this.colorFlag&&this.$el.css("color","#666")},e.prototype.onMouseLeave=function(){document.activeElement!==this._el&&this.colorFlag&&this.$el.css("color","rgb(255, 255, 255)")},e.prototype.onFocus=function(){this.$el.css({border:"1px solid #0082d5"}),this.colorFlag&&this.$el.css("color","rgb(102, 102, 102)"),this.$el.find("span")&&this.$el.find("span").eq(0).remove()},e.prototype.onBlur=function(){if(this.placeholder||""!==this.$el.text())this.$el.css({background:"",border:"1px solid transparent",overflow:"hidden","text-overflow":"ellipsis"}).scrollLeft(0),this.colorFlag&&this.$el.css("color","rgb(255, 255, 255)"),""===this.$el.text()&&void 0===this.myContenteditable||(this.$el.text()!==this.myContenteditable?this.myContenteditableChange.emit(this.$el.text()):this.myContentApplyOnChangeAlways&&this.myContenteditableChange.emit(this.$el.text())),this._initPlaceholder();else{this.$el.focus();var e,t=0,o=this.$el;e=setInterval(function(){t<=5?(t%2?o.css("border","#0082d5 solid 1px"):o.css("border","#ff9948 solid 1px"),t++):clearInterval(e)},100)}},e.prototype._initPlaceholder=function(){""===this.$el.text()?(this.placeholder=void 0===this.placeholder?"":this.placeholder,this.$el.append("<span>"+this.placeholder+"</span>")):this.$el.find("span")&&this.$el.find("span").eq(0).remove()},e}();__decorate([core_1.Input(),__metadata("design:type",String)],Contenteditable.prototype,"myContenteditable",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],Contenteditable.prototype,"placeholder",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],Contenteditable.prototype,"myContentApplyOnChangeAlways",void 0),__decorate([core_1.Output(),__metadata("design:type",Object)],Contenteditable.prototype,"myContenteditableChange",void 0),Contenteditable=__decorate([core_1.Directive({selector:"[myContenteditable]",host:{"(mouseenter)":"onMouseEnter()","(mouseleave)":"onMouseLeave()","(focus)":"onFocus()","(blur)":"onBlur()"},providers:[]}),__metadata("design:paramtypes",[core_1.ElementRef,platform_browser_1.DomSanitizer])],Contenteditable),exports.Contenteditable=Contenteditable;