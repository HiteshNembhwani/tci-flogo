"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),__decorate=this&&this.__decorate||function(e,t,i,r){var s,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(n<3?s(o):n>3?s(t,i,o):s(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),fields_base_component_1=require("../fields.base/fields.base.component"),ng2_translate_1=require("ng2-translate"),lodash=require("lodash"),ConnectionsFormBuilderFieldsTextArea=function(e){function t(t){var i=e.call(this,t)||this;return i.translate=t,i}return __extends(t,e),t.prototype.onChangeField=function(e){if("Escape"===e.key)return this._info=Object.assign({},this.originalInfo),this._value=this._info.value,void this.publishNextChange();this._info.value=this.getValidatedValue(e.target.value,!0,!0),this.publishNextChange()},t.prototype.ngOnInit=function(){this._info.value&&(this._info.isTrigger||this._info.isTask&&"input"===this._info.direction)&&(this._value=this.getValidatedValue(this._info.value,!1,!1))},t.prototype.getValidatedValue=function(e,t,i){void 0===i&&(i=!1);var r,s=!1;try{e?t?r=JSON.parse(e):lodash.isNumber(this._info.value)||lodash.isString(this._info.value)||lodash.isBoolean(this._info.value)?(r=""+this._info.value,s=!0):r=JSON.stringify(e):r=""}catch(t){r=""+e,s=!0}return this._hasError=s,s?(this._errorMessage="Invalid JSON",i&&this._fieldObserver.next(this._getMessage("validation",{status:"error",field:this._info.name}))):(this._errorMessage="",i&&this._fieldObserver.next(this._getMessage("validation",{status:"ok",field:this._info.name}))),r},t}(fields_base_component_1.ConnectionsFormBuilderFieldsBase);ConnectionsFormBuilderFieldsTextArea=__decorate([core_1.Component({selector:"connections-form-builder-fields-textarea",styleUrls:["fields.textarea.css","../fields.base/fields.base.css"],moduleId:module.id,templateUrl:"fields.textarea.tpl.html",inputs:["_info:info","_fieldObserver:fieldObserver"]}),__metadata("design:paramtypes",[ng2_translate_1.TranslateService])],ConnectionsFormBuilderFieldsTextArea),exports.ConnectionsFormBuilderFieldsTextArea=ConnectionsFormBuilderFieldsTextArea;