"use strict";var __decorate=this&&this.__decorate||function(e,t,r,s){var n,o=arguments.length,i=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,s);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(i=(o<3?n(i):o>3?n(t,r,i):n(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var serviceurls_1=require("./../shared/serviceurls"),http_1=require("@angular/http"),core_1=require("@angular/core"),rxjs_extensions_1=require("../../common/rxjs-extensions"),lodash=require("lodash"),FlowsListService=function(){function e(e){this.http=e,this.httpHeaders=new http_1.Headers({"Content-Type":"application/json"}),this.httpOptions=new http_1.RequestOptions({headers:this.httpHeaders})}return e.prototype.getFlowsList=function(e){return this.http.get(serviceurls_1.SERVICE_URLS.APP+e,this.httpOptions).map(function(e){return e.json()}).catch(function(e){return rxjs_extensions_1.Observable.throw(e.json().error||"Server error")})},e.prototype.putApp=function(e){return this.http.put(serviceurls_1.SERVICE_URLS.APP+e.id,e,this.httpOptions).map(function(e){return e.json()}).catch(function(e){return rxjs_extensions_1.Observable.throw(e.json().error||"Server error")})},e.prototype.getMetaData=function(e){return this.http.get(serviceurls_1.SERVICE_URLS.METADATA+e,this.httpOptions).map(function(e){return e.json()}).catch(function(e){return rxjs_extensions_1.Observable.throw(e.json().error||"Server error")})},e.prototype.createApp=function(e){return this.http.post(serviceurls_1.SERVICE_URLS.APP,e).map(function(e){return e.json()}).catch(function(e){return rxjs_extensions_1.Observable.throw(e.json().error||"Server error")})},e.prototype.pushApp=function(e){var t=this;return rxjs_extensions_1.Observable.create(function(r){e.isPushed=!0,e.appChanges=0,t.putApp(e).subscribe(function(s){var n="PUSHVERSION:"+e.id;t.getFlowsList(n).subscribe(function(s){s.id?(e.id=n,t.putApp(e).subscribe(function(e){r.next(e)})):(e.id=n,t.createApp(lodash.cloneDeep(e)).subscribe(function(s){t.putApp(e).subscribe(function(e){r.next(e)})}))})})})},e}();FlowsListService=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[http_1.Http])],FlowsListService),exports.FlowsListService=FlowsListService;